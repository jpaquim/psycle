#! /usr/bin/env bash

set -u &&

main()
{
	cd $(dirname $0)/.. &&
	local dir=$(./root)/packageneric/+autogenerated/package/meta-information &&
	local option__ensure=false &&
	local option__refresh=false &&
	local names= &&
	while test $# != 0
	do
		case $1 in
			--ensure) option__ensure=true ;;
			--refresh) option__refresh=true ;;
			*) names="$names $1" ;;
		esac &&
		shift ||
		return
	done &&
	if $option__refresh || $option__ensure
	then
		if $option__refresh || test ! -e $dir
		then
			. ./find &&
		 	local file=$(cd autogenerate && eval find . $(packageneric__find__file__no_arch -path \\\*/package/meta-information)) &&
			./autogenerate/autogenerate $(dirname $file) $(basename $file)
		fi
	else
		for name in $names
		do
			eval echo $(cat $dir/$name) ||
			return
		done
	fi
} &&

main "$@"
