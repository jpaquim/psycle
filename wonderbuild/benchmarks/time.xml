<?xml version='1.0' encoding='ascii' ?>
<!--?xml-stylesheet type='text/xsl' href='http://psycle.sourceforge.net/displayer.xsl'?-->
<?xml-stylesheet type='text/xsl' href='time.xsl'?>
<!--?xml-stylesheet href='http://psycle.sourceforge.net/displayer.psycledelics.css' type='text/css'?-->
<part caption='Benchmarks of various build tools' image='http://upload.wikimedia.org/wikipedia/commons/thumb/5/5d/Koch_curve.svg/180px-Koch_curve.svg.png' alt='koch curve'>
	<part caption='genbench.py (from waf)' anchor='genbench.py'>
		<part caption='Notes'>
			In these benchmarks, all tools were run with silent/quiet option and/or &gt; /dev/null.
			<br/>
			All tests were run with 4 jobs on the same quad core system, ext2 filesystem on lvm/dmraid0 device, linux, gcc's C++ compiler.
			<br/>
			Waf's parallel algorithm was set to "normal" (faster than "max parallel").
			<br/>
			All tests were run at least seven times (first run not counted) and the average taken (sorry, didn't measure incertitude).
			Initial builds for scons and autools were not run seven times, they take AGES.
			<br/>
			Since genbench.py produces a random setup, all these tests were run on the same genbench output,
			but each copied to its own directory to ensure they don't interfere with each others, i.e.
			<code>
				<pre>
	./genbench.py bench 50 100 15 5
	cp -R bench bench-make
	cp -R bench bench-wonderbuild
	cp -R bench bench-waf
	cp -R bench bench-autotools
	cp -R bench bench-scons
				</pre>
			</code>
			This genbench.py invocation generates 10000 tiny interdependent C++ source and header files, to be built into 50 static libs.
			<br/>
			The autotools generated only one makefile with everything (no recursive make invocation), and C++ dependencies were tracked with gcc while compiling.
			<br/>
			The toy makefiles generated were recursive, and C++ dependencies were tracked with the makedepend X utility.
			<br/>
			Unlike waf and scons, which used a full-featured preprocessor to scan C++ dependencies,
			wonderbuild used a dumb preprocessor scanner, with no macro evaluation.
			<br/>
			Waf and scons were tuned to use file timestamps comparisons rather than md5 sums.
			<br/>
			Configuration time was not counted (altough it's not really clear for scons).
			<part caption='Running wonderbuild'>
				You can try wonderbuild with this benchmark with:
				<code>
					<pre>
	svn co https://psycle.svn.sourceforge.net/svnroot/psycle/branches/bohan/wonderbuild --ignore-externals
	cd wonderbuild/benchmarks
	./genbench.py bench 50 100 15 5
	cp -R bench bench-wonderbuild
	time ../wonderbuild.py --cxx-pic=no --silent # initial full build
	time ../wonderbuild.py --cxx-pic=no --silent # no-op build
	touch bench-wonderbuild/lib_17/class_17.h &amp;&amp; time ../wonderbuild.py --cxx-pic=no --silent # small partial rebuild
	touch bench-wonderbuild/lib_17/*.h &amp;&amp; time ../wonderbuild.py --cxx-pic=no --silent # big partial rebuild
					</pre>
				</code>
				The build dir is benchmarks/++wonderbuild
			</part>
		</part>
		<part caption='Results'>
			<part caption='Initial full build'>
				<code>
					<table style='background-color: rgb(95%, 95%, 85%)'>
						<tr>
							<td align='right'>toy makefiles</td>
							<td width='10px'/>
							<td align='right'> 35.2s</td>
							<td><div style='background-color: orange; width: 35px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>wonderbuild</td>
							<td width='10px'/>
							<td align='right'> 39.8s</td>
							<td><div style='background-color: orange; width: 40px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>waf</td>
							<td width='10px'/>
							<td align='right'> 46.0s</td>
							<td><div style='background-color: orange; width: 46px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>scons</td>
							<td width='10px'/>
							<td align='right'>128.0s</td>
							<td><div style='background-color: orange; width: 128px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>autotools</td>
							<td width='10px'/>
							<td align='right'>188.0s</td>
							<td><div style='background-color: orange; width: 188px'><br/></div></td>
						</tr>
					</table>
				</code>
			</part>
			<part caption='No-op build'>
				<code>
					<table style='background-color: rgb(95%, 95%, 85%)'>
						<tr>
							<td align='right'>toy makefiles</td>
							<td width='10px'/>
							<td align='right'> 1.00s</td>
							<td><div style='background-color: orange; width: 100px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>wonderbuild</td>
							<td width='10px'/>
							<td align='right'> 1.05s</td>
							<td><div style='background-color: orange; width: 105px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>waf</td>
							<td width='10px'/>
							<td align='right'> 1.71s</td>
							<td><div style='background-color: orange; width: 171px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>autotools</td>
							<td width='10px'/>
							<td align='right'> 3.50s</td>
							<td><div style='background-color: orange; width: 350px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>scons</td>
							<td width='10px'/>
							<td align='right'>22.00s</td>
							<td><div style='background-color: orange; width: 2200px'><br/></div></td>
						</tr>
					</table>
				</code>
			</part>
			<part caption='Small partial rebuild'>
				After modification of lib_x/class_x.h, rebuild of 19 object files from c++ and 6 static libs
				<br/><br/>
				<code>
					<table style='background-color: rgb(95%, 95%, 85%)'>
						<tr>
							<td align='right'>toy makefiles</td>
							<td width='10px'/>
							<td align='right'> 1.23s</td>
							<td><div style='background-color: orange; width: 123px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>wonderbuild</td>
							<td width='10px'/>
							<td align='right'> 1.25s</td>
							<td><div style='background-color: orange; width: 125px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>waf</td>
							<td width='10px'/>
							<td align='right'> 2.14s</td>
							<td><div style='background-color: orange; width: 214px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>autotools</td>
							<td width='10px'/>
							<td align='right'> 5.40s</td>
							<td><div style='background-color: orange; width: 540px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>scons</td>
							<td width='10px'/>
							<td align='right'>26.00s</td>
							<td><div style='background-color: orange; width: 2600px'><br/></div></td>
						</tr>
					</table>
				</code>
			</part>
			<part caption='Big partial rebuild'>
				After modification of lib_x/*.h, rebuild of 575 object files from c++ and 33 static libs
				<br/><br/>
				<code>
					<table style='background-color: rgb(95%, 95%, 85%)'>
						<tr>
							<td align='right'>toy makefiles</td>
							<td width='10px'/>
							<td align='right'> 5.25s</td>
							<td><div style='background-color: orange; width: 52px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>wonderbuild</td>
							<td width='10px'/>
							<td align='right'> 5.70s</td>
							<td><div style='background-color: orange; width: 57px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>waf</td>
							<td width='10px'/>
							<td align='right'> 6.98s</td>
							<td><div style='background-color: orange; width: 70px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>autotools</td>
							<td width='10px'/>
							<td align='right'>29.80s</td>
							<td><div style='background-color: orange; width: 298px'><br/></div></td>
						</tr>
						<tr>
							<td align='right'>scons</td>
							<td width='10px'/>
							<td align='right'>41.00s</td>
							<td><div style='background-color: orange; width: 410px'><br/></div></td>
						</tr>
					</table>
				</code>
			</part>
		</part>
	</part>
</part>
